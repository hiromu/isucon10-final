!function(e){function a(a){for(var n,l,s=a[0],c=a[1],o=a[2],u=0,d=[];u<s.length;u++)l=s[u],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&d.push(i[l][0]),i[l]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(m&&m(a);d.length;)d.shift()();return r.push.apply(r,o||[]),t()}function t(){for(var e,a=0;a<r.length;a++){for(var t=r[a],n=!0,s=1;s<t.length;s++){var c=t[s];0!==i[c]&&(n=!1)}n&&(r.splice(a--,1),e=l(l.s=t[0]))}return e}var n={},i={1:0},r=[];function l(a){if(n[a])return n[a].exports;var t=n[a]={i:a,l:!1,exports:{}};return e[a].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=e,l.c=n,l.d=function(e,a,t){l.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,a){if(1&a&&(e=l(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(l.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)l.d(t,n,function(a){return e[a]}.bind(null,n));return t},l.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(a,"a",a),a},l.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},l.p="/packs/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=a,s=s.slice();for(var o=0;o<s.length;o++)a(s[o]);var m=c;r.push([62,0]),t()}({62:function(e,a,t){"use strict";t.r(a);t(20);var n=t(7),i=t(1);class r{constructor(e){this.apiClient=e,this.baseUrl=this.apiClient.baseUrl}async listClarifications(e){const a=i.xsuportal.proto.services.admin.ListClarificationsResponse,t=await this.request(`${this.baseUrl}/api/admin/clarifications?team_id=${encodeURIComponent(e||"")}`,"GET",null,null);return a.decode(new Uint8Array(await t.arrayBuffer()))}async getClarification(e){const a=i.xsuportal.proto.services.admin.GetClarificationResponse,t=await this.request(`${this.baseUrl}/api/admin/clarifications/${encodeURIComponent(e.toString())}`,"GET",null,null);return a.decode(new Uint8Array(await t.arrayBuffer()))}async respondClarification(e){const a=i.xsuportal.proto.services.admin.RespondClarificationResponse,t=i.xsuportal.proto.services.admin.RespondClarificationRequest,n=e?t.encode(t.fromObject(e)).finish():null,r=await this.request(`${this.baseUrl}/api/admin/clarifications/${encodeURIComponent(e.id.toString())}`,"PUT",null,n);return a.decode(new Uint8Array(await r.arrayBuffer()))}async createClarification(e){const a=i.xsuportal.proto.services.admin.CreateClarificationResponse,t=i.xsuportal.proto.services.admin.CreateClarificationRequest,n=e?t.encode(t.fromObject(e)).finish():null,r=await this.request(this.baseUrl+"/api/admin/clarifications","POST",null,n);return a.decode(new Uint8Array(await r.arrayBuffer()))}request(e,a,t,n){return this.apiClient.request(e,a,t,n)}}var l=t(0),s=t.n(l),c=t(3),o=t(4);class m extends s.a.Component{constructor(e){super(e),this.state={}}render(){return s.a.createElement("nav",{className:"navbar is-light",role:"navigation","aria-label":"main navigation"},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"navbar-brand"},s.a.createElement(c.b,{className:"navbar-item",to:"/admin/"},"XSUCON Admin"))))}onLogout(e){e.preventDefault();const a=document.createElement("form");a.method="POST",a.action="/session",document.body.appendChild(a);const t=document.createElement("input");t.type="hidden",t.name="_method",t.value="delete",a.appendChild(t),a.submit()}}var u=t(12),d=t(15),p=t(2);const f=e=>{const[a,t]=s.a.useState(null),[n,i]=s.a.useState(null);s.a.useEffect(()=>{e.client.listClarifications().then(e=>i(e.clarifications)).catch(e=>t(e))},[]);return s.a.createElement(s.a.Fragment,null,a?s.a.createElement(p.a,{error:a}):null,n?n?n.map(e=>s.a.createElement(d.a,{clarification:e,admin:!0,key:e.id.toString()})):null:s.a.createElement("p",null,"Loading.."))},h=e=>{const[a,t]=s.a.useState(!1),[n,i]=s.a.useState(null),{reset:r,register:l,handleSubmit:c,watch:o,setValue:m,errors:d}=Object(u.a)({shouldUnregister:!1,defaultValues:{question:e.clarification.question,answer:e.clarification.answer,disclose:e.clarification.disclosed}}),f=c(async(a,n)=>{try{t(!0),console.log(a);const i=await e.client.respondClarification({id:e.clarification.id,answer:a.answer,question:a.question,disclose:a.disclose});e.onSubmit(i.clarification),n.target.reset(),t(!1)}catch(n){i(n),t(!1)}});return s.a.createElement("div",{className:"card mt-5"},s.a.createElement("div",{className:"card-header"},s.a.createElement("h4",{className:"is-4 card-header-title"},"Response")),s.a.createElement("div",{className:"card-content"},s.a.createElement("form",{onSubmit:f},s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column field is-6"},s.a.createElement("label",{className:"label",htmlFor:"AdminClarificationDetail-question"},"Question"),s.a.createElement("div",{className:"control"},s.a.createElement("textarea",{className:"textarea",name:"question",id:"AdminClarificationDetail-question",ref:l,placeholder:"",autoFocus:!0,disabled:!0}))),s.a.createElement("div",{className:"column field is-6"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label",htmlFor:"AdminClarificationDetail-answer"},"Answer"),s.a.createElement("div",{className:"control"},s.a.createElement("textarea",{className:"textarea",name:"answer",id:"AdminClarificationDetail-answer",ref:l,placeholder:""}))))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"checkbox"},s.a.createElement("input",{type:"checkbox",name:"disclose",ref:l}),"Disclose (Visible to all teams)"))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{className:"button is-primary",type:"submit",disabled:a},"Respond"))),n?s.a.createElement(p.a,{error:n}):null)))},E=e=>{const[a,t]=s.a.useState(null),[n,i]=s.a.useState(null);s.a.useEffect(()=>{e.client.getClarification(parseInt(e.id,10)).then(e=>i(e.clarification)).catch(e=>t(e))},[]);return s.a.createElement(s.a.Fragment,null,a?s.a.createElement(p.a,{error:a}):null,n?s.a.createElement(d.a,{clarification:n,admin:!0}):s.a.createElement("p",null,"Loading.."),n?s.a.createElement(h,{session:e.session,client:e.client,onSubmit:e=>{i(e)},clarification:n}):null)};class v extends s.a.Component{constructor(e){super(e),this.state={adminClient:new r(this.props.client)}}render(){return s.a.createElement(c.a,null,s.a.createElement(m,{session:this.props.session,client:this.state.adminClient}),s.a.createElement("div",{className:"container mt-5"},s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column is-3"},s.a.createElement("aside",{className:"menu"},s.a.createElement("p",{className:"menu-label"},"Contest"),s.a.createElement("ul",{className:"menu-list"},s.a.createElement("li",null,s.a.createElement(c.c,{to:"/admin/clarifications",activeClassName:"is-active"},"Clarifications"))))),s.a.createElement("div",{className:"column is-9"},s.a.createElement("main",null,s.a.createElement(o.d,null,s.a.createElement(o.b,{exact:!0,path:"/admin/clarifications",render:({match:e})=>s.a.createElement(f,{session:this.props.session,client:this.state.adminClient})}),s.a.createElement(o.b,{exact:!0,path:"/admin/clarifications/:id",render:({match:e})=>s.a.createElement(E,{session:this.props.session,client:this.state.adminClient,id:e.params.id})})))))))}}var b=t(16),y=t.n(b);!async function(){var e;const a=new n.a,t=await a.getCurrentSession(),i=document.getElementById("app");(null===(e=t.contestant)||void 0===e?void 0:e.isStaff)?y.a.render(s.a.createElement(v,{session:t,client:a}),i):location.href="/"}()}});
//# sourceMappingURL=admin.js.map